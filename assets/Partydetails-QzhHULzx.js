import{r as a,j as e,v as U,w as u,D as S,x as W,y as I,z as K,G as l,Y,Z as J,_ as Q,$ as C,F as c,H as A,I as Z,J as X,K as ee,M as B,O as s,Q as re,S as N,U as te,V as ae,W as j}from"./index-B24U4oXx.js";import{C as ne}from"./CircularProgress-BB-a29aZ.js";function oe(){const[n,p]=a.useState({party_name:"",gst_number:"",party_type:"",phone:"",email:"",address:"",description:""}),[i,h]=a.useState([]),[m,D]=a.useState({add:!1}),[q,x]=a.useState(!1),[y,b]=a.useState(null),[L,O]=a.useState(null),[F,g]=a.useState(!1),R=a.useRef(null),P=a.useRef(null),G=a.useRef(null),_=a.useRef(null),v=a.useRef(null),w=a.useRef(null),E=a.useRef(null);a.useEffect(()=>{(async()=>{try{const t=await j.get("/api/user/party/");h(t.data.data),alert(t.data.message)}catch(t){console.error("Error fetching items:",t)}})()},[]);const o=r=>{p({...n,[r.target.name]:r.target.value})},V=()=>{x(!0),b(null)},T=()=>{x(!1)},$=async r=>{r.preventDefault(),D({...m,add:!0});try{if(y!==null){const t=await j.put(`/api/user/party/${n.party_name}/`,n),f=[...i];f[y]=t.data,alert(t.data.message),h(f)}else{const t=await j.post("/api/user/party/",n);h([...i,t.data]),alert(t.data.message)}}catch(t){console.error("Error adding/updating party:",t)}finally{D({...m,add:!1}),p({party_name:"",gst_number:"",party_type:"",phone:"",email:"",address:"",description:""}),x(!1)}},z=r=>{p(i[r]),b(r),x(!0)},H=r=>{O(r),g(!0),p(i[r])},M=async()=>{try{await j.delete(`/api/user/party/${n.party_name}/`,n);const r=i.filter((t,f)=>f!==L);h(r)}catch(r){console.error("Error deleting party:",r)}finally{g(!1)}},k=()=>{g(!1)},d=(r,t)=>{r.key==="Enter"&&t&&(r.preventDefault(),t.current.focus())};return e.jsxs(U,{sx:{maxWidth:"100%",padding:2},children:[e.jsx(u,{variant:"contained",color:"secondary",onClick:V,children:y!==null?"Edit Party":"Add Party"}),e.jsxs(S,{open:q,onClose:T,maxWidth:"md",fullWidth:!0,children:[e.jsx(W,{style:{backgroundColor:"#f9dff5"},children:y!==null?"Edit Party Details":"Add Party Details"}),e.jsx(I,{style:{backgroundColor:"#f9dff5"},children:e.jsx(K,{sx:{padding:"10px",backgroundColor:"#f9dff5"},elevation:0,children:e.jsxs("form",{children:[e.jsxs(l,{container:!0,spacing:2,marginBottom:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsxs(Y,{fullWidth:!0,margin:"normal",required:!0,children:[e.jsx(J,{children:"Party Type"}),e.jsxs(Q,{value:n.party_type,name:"party_type",onChange:o,label:"Party Type",inputRef:G,onKeyDown:r=>d(r,R),children:[e.jsx(C,{value:"Vendor",children:"Vendor"}),e.jsx(C,{value:"Supplier",children:"Supplier"}),e.jsx(C,{value:"Customer",children:"Customer"})]})]})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"Party Name",name:"party_name",value:n.party_name,onChange:o,margin:"normal",required:!0,inputRef:R,onKeyDown:r=>d(r,P)})})]}),e.jsxs(l,{container:!0,spacing:2,marginBottom:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"Party Registration/GST Number",name:"gst_number",value:n.gst_number,onChange:o,margin:"normal",required:!0,inputRef:P,onKeyDown:r=>d(r,_)})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"Phone Number",name:"phone",value:n.phone,onChange:o,margin:"normal",required:!0,inputRef:_,onKeyDown:r=>d(r,v)})})]}),e.jsxs(l,{container:!0,spacing:2,marginBottom:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"Email",name:"email",value:n.email,onChange:o,margin:"normal",required:!0,inputRef:v,onKeyDown:r=>d(r,w)})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,multiline:!0,label:"Address",name:"address",value:n.address,onChange:o,margin:"normal",required:!0,inputRef:w,onKeyDown:r=>d(r,E)})})]}),e.jsx(c,{fullWidth:!0,multiline:!0,rows:3,label:"Description",name:"description",value:n.description,onChange:o,margin:"normal",inputRef:E})]})})}),e.jsxs(A,{style:{backgroundColor:"#f9dff5"},children:[e.jsx(u,{onClick:T,color:"error",children:"Cancel"}),e.jsx(u,{onClick:$,color:"secondary",disabled:m.add,children:m.add?e.jsx(ne,{size:24}):"Submit"})]})]}),e.jsxs(S,{open:F,onClose:k,children:[e.jsx(W,{children:"Confirm Delete"}),e.jsx(I,{children:"Are you sure you want to delete this party?"}),e.jsxs(A,{children:[e.jsx(u,{onClick:k,color:"error",children:"No"}),e.jsx(u,{onClick:M,color:"secondary",children:"Yes"})]})]}),e.jsx(Z,{component:K,sx:{marginTop:2},children:e.jsxs(X,{children:[e.jsx(ee,{children:e.jsxs(B,{children:[e.jsx(s,{children:"Party Name"}),e.jsx(s,{children:"Party Type"}),e.jsx(s,{children:"Phone"}),e.jsx(s,{children:"Email"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(re,{children:i.map((r,t)=>e.jsxs(B,{children:[e.jsx(s,{children:r.party_name}),e.jsx(s,{children:r.party_type}),e.jsx(s,{children:r.phone}),e.jsx(s,{children:r.email}),e.jsxs(s,{children:[e.jsx(N,{onClick:()=>z(t),color:"primary",children:e.jsx(te,{})}),e.jsx(N,{onClick:()=>H(t),color:"error",children:e.jsx(ae,{})})]})]},r.party_name))})]})})]})}export{oe as default};
